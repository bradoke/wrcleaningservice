<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8"/>
<meta name="description" content="WR Cleaning Service â€” Sistema de GestÃ£o Financeira.">
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>WR Cleaning Service</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{--primary:#2563eb;--primary-light:#dbeafe;--primary-dark:#1d4ed8;--secondary:#10b981;--secondary-light:#d1fae5;--destructive:#ef4444;--destructive-light:#fee2e2;--warning:#f97316;--warning-light:#ffedd5;--bg:#f8fafc;--card:#ffffff;--border:#e2e8f0;--text:#0f172a;--text-muted:#64748b;--sidebar-w:240px;--header-h:64px;--radius:10px}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--text);min-height:100vh}
button{cursor:pointer;font-family:inherit;border:none;background:none}
input,select,textarea{font-family:inherit}
.hidden{display:none!important}
.mb-4{margin-bottom:16px}.mt-4{margin-top:16px}

/* TOAST */
#toast-container{position:fixed;bottom:24px;right:24px;z-index:9999;display:flex;flex-direction:column;gap:8px}
.toast{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:12px 16px;font-size:13px;font-weight:500;box-shadow:0 8px 24px rgba(0,0,0,.12);min-width:260px;display:flex;align-items:center;gap:8px;animation:slideIn .25s ease}
.toast.success{border-left:4px solid var(--secondary)}
.toast.error{border-left:4px solid var(--destructive)}
@keyframes slideIn{from{transform:translateX(60px);opacity:0}to{transform:translateX(0);opacity:1}}

/* MODAL */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:1000;display:flex;align-items:center;justify-content:center;padding:16px;animation:fadeIn .15s ease}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.modal{background:var(--card);border-radius:14px;padding:28px;width:100%;max-width:460px;max-height:90vh;overflow-y:auto;box-shadow:0 24px 64px rgba(0,0,0,.18)}
.modal h2{font-size:18px;font-weight:700;margin-bottom:20px}
.modal-lg{max-width:600px}

/* FORMS */
.form-group{margin-bottom:14px}
.form-group label{display:block;font-size:13px;font-weight:500;margin-bottom:5px}
.form-control{width:100%;padding:9px 12px;border:1.5px solid var(--border);border-radius:8px;font-size:14px;outline:none;transition:border-color .15s;background:#fff}
.form-control:focus{border-color:var(--primary)}
select.form-control{appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%2364748b' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center;padding-right:32px}
textarea.form-control{resize:vertical;min-height:80px}

/* BUTTONS */
.btn{display:inline-flex;align-items:center;justify-content:center;gap:6px;padding:9px 18px;border-radius:8px;font-size:13px;font-weight:600;transition:all .15s;cursor:pointer}
.btn-primary{background:var(--primary);color:#fff;border:1.5px solid var(--primary)}
.btn-primary:hover{background:var(--primary-dark)}
.btn-secondary{background:var(--secondary);color:#fff;border:1.5px solid var(--secondary)}
.btn-outline{background:transparent;color:var(--text);border:1.5px solid var(--border)}
.btn-outline:hover{background:var(--bg)}
.btn-ghost{background:transparent;color:var(--text-muted);border:1.5px solid transparent;padding:6px 10px}
.btn-ghost:hover{background:var(--bg);color:var(--text)}
.btn-danger{background:var(--destructive-light);color:var(--destructive);border:1.5px solid transparent}
.btn-danger:hover{background:var(--destructive);color:#fff}
.btn-sm{padding:6px 12px;font-size:12px}
.btn-icon{padding:7px;border-radius:7px}
.btn-full{width:100%}

/* BADGE */
.badge{display:inline-flex;align-items:center;padding:2px 8px;border-radius:99px;font-size:11px;font-weight:600}
.badge-primary{background:var(--primary-light);color:var(--primary)}
.badge-secondary{background:var(--secondary-light);color:var(--secondary)}
.badge-destructive{background:var(--destructive-light);color:var(--destructive)}
.badge-warning{background:var(--warning-light);color:var(--warning)}
.badge-gray{background:#f1f5f9;color:var(--text-muted)}
.badge-pending{background:var(--primary-light);color:var(--primary)}

/* CARD */
.card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius)}
.card-header{padding:16px 20px 8px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.card-header h3{font-size:15px;font-weight:700}
.card-body{padding:16px 20px}
.stat-card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:16px 20px}
.stat-card .stat-label{font-size:12px;font-weight:500;color:var(--text-muted);margin-bottom:4px}
.stat-card .stat-value{font-size:26px;font-weight:700}

/* TABLE */
.table{width:100%;border-collapse:collapse;font-size:13px}
.table th{text-align:left;padding:10px 12px;font-weight:600;border-bottom:2px solid var(--border);color:var(--text-muted);font-size:12px}
.table td{padding:10px 12px;border-bottom:1px solid var(--border);vertical-align:middle}
.table tr:last-child td{border-bottom:none}
.table tr:hover td{background:var(--bg)}
.table-responsive{overflow-x:auto}

/* LOGIN */
#login-page{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,var(--primary-light) 0%,#fff 50%,var(--secondary-light) 100%);padding:20px}
.login-card{background:var(--card);border:1px solid var(--border);border-radius:18px;padding:40px;width:100%;max-width:420px;box-shadow:0 20px 60px rgba(37,99,235,.1)}
.login-logo{display:flex;flex-direction:column;align-items:center;gap:10px;margin-bottom:28px}
.login-logo .spark{color:var(--primary);font-size:36px;animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.6}}
.login-logo h1{font-size:22px;font-weight:800;background:linear-gradient(135deg,var(--primary),var(--secondary));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;text-align:center}
.login-logo p{font-size:13px;color:var(--text-muted)}
.login-switch{text-align:center;font-size:13px;color:var(--text-muted);margin-top:10px}
.login-switch button{color:var(--primary);font-weight:600;cursor:pointer}
.login-switch button:hover{text-decoration:underline}

/* APP */
#app-page,#emp-app-page{display:flex;flex-direction:column;min-height:100vh}
.app-header{height:var(--header-h);background:var(--card);border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;padding:0 20px;position:sticky;top:0;z-index:100;box-shadow:0 1px 4px rgba(0,0,0,.06)}
.header-logo{display:flex;align-items:center;gap:10px}
.header-logo .spark{color:var(--primary);font-size:22px}
.header-logo h2{font-size:16px;font-weight:800;background:linear-gradient(135deg,var(--primary),var(--secondary));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.header-logo span{font-size:10px;color:var(--text-muted);display:block}
.header-right{display:flex;align-items:center;gap:12px}
.user-info .name{font-size:13px;font-weight:600}
.user-info .email{font-size:11px;color:var(--text-muted)}
.app-body{display:flex;flex:1}

/* SIDEBAR */
.sidebar{width:var(--sidebar-w);background:var(--card);border-right:1px solid var(--border);padding:12px 10px;position:sticky;top:var(--header-h);height:calc(100vh - var(--header-h));overflow-y:auto;flex-shrink:0}
.nav-item{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:8px;font-size:13px;font-weight:500;color:var(--text-muted);cursor:pointer;transition:all .15s;width:100%}
.nav-item:hover{background:var(--bg);color:var(--text)}
.nav-item.active{background:var(--primary);color:#fff}
.nav-item .icon{font-size:16px;flex-shrink:0}
.nav-badge{margin-left:auto;background:var(--destructive);color:#fff;font-size:10px;font-weight:700;border-radius:99px;min-width:18px;height:18px;display:flex;align-items:center;justify-content:center;padding:0 4px}
.main-content{flex:1;padding:24px;overflow-x:hidden}

/* TABS */
.tab-content{display:none;animation:fadeUp .2s ease}
.tab-content.active{display:block}
@keyframes fadeUp{from{transform:translateY(8px);opacity:0}to{transform:translateY(0);opacity:1}}
.page-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px}
.page-header h2{font-size:22px;font-weight:800}

/* GRID */
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
.grid-4{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
.divider{border:none;border-top:1px solid var(--border);margin:16px 0}

/* NOTIF BANNER */
.notif-banner{background:var(--destructive-light);border:1px solid #fca5a5;border-radius:var(--radius);padding:14px 16px;display:flex;align-items:center;gap:12px;margin-bottom:20px}
.notif-banner .title{font-weight:700;color:var(--destructive);font-size:14px}
.notif-banner .desc{font-size:12px;color:var(--text-muted)}

/* LOG ROW */
.log-row{border:1px solid var(--border);border-radius:8px;padding:12px 14px;margin-bottom:8px;display:flex;align-items:flex-start;justify-content:space-between;gap:12px}
.log-row:hover{border-color:var(--primary)}
.log-row .log-date{font-size:12px;color:var(--text-muted)}
.log-row .log-client{font-size:14px;font-weight:600}
.log-row .log-employees{font-size:12px;color:var(--text-muted);margin-top:4px}
.log-row .log-revenue{font-size:16px;font-weight:700;color:var(--secondary)}

/* WEEK SCHEDULE */
.week-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:8px}
.day-col{border:1px solid var(--border);border-radius:8px;min-height:100px;padding:8px}
.day-col .day-label{font-size:11px;font-weight:700;text-align:center;color:var(--text-muted);margin-bottom:6px}
.day-col .day-num{font-size:16px;font-weight:700;text-align:center;margin-bottom:8px}
.day-col.today{border-color:var(--primary);background:var(--primary-light)}
.schedule-item{background:var(--card);border:1px solid var(--border);border-radius:6px;padding:6px 8px;font-size:11px;margin-bottom:4px}
.schedule-item.confirmado{border-left:3px solid var(--secondary)}
.schedule-item.pendente{border-left:3px solid var(--warning)}
.schedule-item.cancelado{border-left:3px solid var(--destructive);opacity:.7}

/* COST */
.cost-item{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border:1px solid var(--border);border-radius:8px;margin-bottom:8px}
.cost-item:hover{border-color:var(--primary)}
.cost-item .cost-cat{font-size:11px;font-weight:600;color:var(--text-muted)}
.cost-item .cost-desc{font-size:14px;font-weight:500}
.cost-item .cost-amount{font-size:16px;font-weight:700}

/* REFERRAL */
.referral-item{border:1px solid var(--border);border-radius:8px;padding:14px;margin-bottom:8px}
.referral-item.pending{border-left:4px solid var(--warning)}
.referral-item.approved{border-left:4px solid var(--secondary)}
.referral-item.rejected{border-left:4px solid var(--destructive)}

/* SUMMARY */
.summary-block{background:var(--bg);border-radius:8px;padding:12px 14px;margin-bottom:8px;display:flex;align-items:center;justify-content:space-between}
.summary-block .emp-name{font-size:13px;font-weight:600}
.summary-block .emp-count{font-size:12px;color:var(--text-muted)}
.summary-block .emp-total{font-size:16px;font-weight:700;color:var(--primary)}

/* PROFILE */
.profile-avatar{width:72px;height:72px;border-radius:99px;background:linear-gradient(135deg,var(--primary),var(--secondary));display:flex;align-items:center;justify-content:center;font-size:28px;color:#fff;font-weight:700}

/* FREQ */
.freq-item{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border:1px solid var(--border);border-radius:8px;margin-bottom:6px}
.freq-item:hover{border-color:var(--primary);background:var(--bg)}

/* NOTIF ITEM */
.notif-item{border:1px solid var(--border);border-radius:8px;padding:14px;margin-bottom:8px}
.notif-item.pending{border-left:4px solid var(--destructive)}
.notif-item.read{border-left:4px solid var(--border);opacity:.8}

/* EMPTY */
.empty{text-align:center;padding:48px 20px;color:var(--text-muted);font-size:14px}
.empty .icon{font-size:40px;margin-bottom:8px}

/* TABS NAV */
.tabs-nav{display:flex;gap:4px;background:var(--bg);border-radius:8px;padding:4px;margin-bottom:16px}
.tab-btn{flex:1;padding:7px 10px;border-radius:6px;font-size:12px;font-weight:600;color:var(--text-muted);text-align:center;cursor:pointer;transition:all .15s}
.tab-btn.active{background:var(--card);color:var(--primary);box-shadow:0 1px 4px rgba(0,0,0,.1)}

/* EMP TAB */
.emp-tab-btn{padding:12px 16px;font-size:13px;font-weight:600;color:var(--text-muted);border-bottom:2px solid transparent;cursor:pointer;background:none;border-top:none;border-left:none;border-right:none;white-space:nowrap;transition:all .15s}
.emp-tab-btn.active{color:var(--primary);border-bottom-color:var(--primary)}
.emp-tab-btn:hover{color:var(--text);background:var(--bg)}
.emp-pill{display:inline-flex;align-items:center;gap:6px;background:var(--primary-light);color:var(--primary);border-radius:99px;padding:3px 10px;font-size:12px;font-weight:500}

/* MOBILE */
.mobile-menu-btn{display:none}
.sidebar-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.4);z-index:150;top:var(--header-h)}
@media(max-width:768px){
  .sidebar{display:none;position:fixed;left:0;top:var(--header-h);height:calc(100vh - var(--header-h));z-index:200;transform:translateX(-100%);transition:transform .25s}
  .sidebar.open{display:flex;flex-direction:column;transform:translateX(0)}
  .mobile-menu-btn{display:flex}
  .main-content{padding:16px}
  .grid-4{grid-template-columns:1fr 1fr}
  .grid-3{grid-template-columns:1fr 1fr}
  .grid-2{grid-template-columns:1fr}
  .week-grid{grid-template-columns:repeat(4,1fr)}
  .user-info{display:none}
  .sidebar-overlay.open{display:block}
}

/* PASSWORD TOGGLE */
.pass-wrapper{position:relative}.pass-wrapper .form-control{padding-right:44px}
.pass-toggle{position:absolute;right:10px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--text-muted);padding:4px;display:flex;align-items:center}.pass-toggle:hover{color:var(--primary)}
/* FORM VALIDATION */
.form-control.is-error{border-color:var(--destructive)!important;box-shadow:0 0 0 3px rgba(239,68,68,.12)}
.form-error{color:var(--destructive);font-size:11px;margin-top:4px;display:none;font-weight:500}.form-error.show{display:block}
/* CHARTS */
.charts-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px}
.chart-container{position:relative;height:270px;padding:4px 8px 12px}
/* USER ROLE BADGE */
.role-badge-adm{background:#dbeafe;color:#1d4ed8;font-size:10px;padding:2px 7px;border-radius:99px;font-weight:700}
.role-badge-col{background:#d1fae5;color:#065f46;font-size:10px;padding:2px 7px;border-radius:99px;font-weight:700}
.no-login-badge{background:#f1f5f9;color:#94a3b8;font-size:10px;padding:2px 7px;border-radius:99px;font-weight:600}
/* AGENDA MOBILE */
.week-scroll-wrapper{overflow-x:auto;-webkit-overflow-scrolling:touch;padding-bottom:6px}
.week-scroll-wrapper::-webkit-scrollbar{height:4px}
.week-scroll-wrapper::-webkit-scrollbar-thumb{background:var(--border);border-radius:4px}
.day-col{min-width:120px}
.schedule-header-row{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px;margin-bottom:16px}
.schedule-nav-group{display:flex;align-items:center;gap:6px;flex-wrap:wrap}
.log-row-inner{display:flex;align-items:flex-start;justify-content:space-between;gap:10px}
/* PRINT */
@media print{.sidebar,.app-header,.mobile-menu-btn,.charts-grid,.notif-banner,.btn{display:none!important}.main-content{padding:0}body{background:#fff}}
@media(max-width:768px){
  .schedule-header-row{flex-direction:column;align-items:flex-start}
  .week-grid{grid-template-columns:repeat(7,minmax(108px,1fr));min-width:756px}
  .log-row-inner{flex-direction:column;gap:6px}
}
@media(max-width:480px){
  .grid-4{grid-template-columns:1fr 1fr}.grid-3{grid-template-columns:1fr 1fr}.grid-2{grid-template-columns:1fr}
  .charts-grid{grid-template-columns:1fr}.stat-card .stat-value{font-size:20px}
  .main-content{padding:10px}.modal{padding:16px 14px}.login-card{padding:28px 18px}
  .week-grid{grid-template-columns:repeat(7,minmax(90px,1fr));min-width:630px}
  .day-col{padding:6px;min-width:90px}.schedule-nav-group{width:100%;justify-content:space-between}
  .log-row{flex-direction:column;gap:8px}.page-header{flex-direction:column;align-items:flex-start;gap:8px}
  .page-header > div{width:100%;justify-content:space-between}.card-header{flex-wrap:wrap;gap:6px}
}
@media(prefers-color-scheme:dark){
  :root{--bg:#0f172a;--card:#1e293b;--text:#f1f5f9;--text-muted:#94a3b8;--border:#334155;--primary-light:#1e3a5f;--secondary-light:#064e3b;--destructive-light:#450a0a;--warning-light:#431407}
  .form-control{background:#0f172a;color:var(--text);border-color:var(--border)}
  select.form-control option{background:#1e293b;color:#f1f5f9}
  .login-logo h1,.header-logo h2{-webkit-text-fill-color:unset;background:none;color:var(--primary)}
  #login-page{background:linear-gradient(135deg,#1e293b 0%,#0f172a 60%,#064e3b 100%)}
  .tab-btn.active{background:var(--card)}.schedule-item{background:#1e293b}
  .day-col.today{background:#1e3a5f;border-color:var(--primary)}.summary-block{background:#1e3a5f}
  .table tr:hover td{background:#1e3a5f}
}

</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
</head>
<body>

<div id="toast-container"></div>

<!-- â•â• LOGIN â•â• -->
<div id="login-page">
  <div class="login-card">
    <div class="login-logo">
      <div class="spark">âœ¦</div>
      <h1>WR Cleaning Service</h1>
      <p>Sistema de GestÃ£o Financeira</p>
    </div>
    <div id="login-form">
      <div class="form-group">
        <label for="login-email">Email</label>
        <input type="email" class="form-control" id="login-email" placeholder="seu@email.com" autocomplete="email"/>
        <span class="form-error" id="login-email-err">Por favor, insira um email vÃ¡lido</span>
      </div>
      <div class="form-group">
        <label for="login-pass">Senha</label>
        <div class="pass-wrapper">
          <input type="password" class="form-control" id="login-pass" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password"/>
          <button class="pass-toggle" id="toggle-pass" type="button" aria-label="Mostrar senha">
            <svg id="eye-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
          </button>
        </div>
        <span class="form-error" id="login-pass-err">Senha nÃ£o pode estar vazia</span>
      </div>
      <button class="btn btn-primary btn-full" id="btn-login">Entrar</button>
      <div class="login-switch"><button id="btn-to-forgot">Esqueci minha senha</button></div>
      <div class="login-switch">NÃ£o tem conta? <button id="btn-to-register">Criar conta</button></div>
    </div>
    <div id="register-form" class="hidden">
      <div class="form-group"><label>Email</label><input type="email" class="form-control" placeholder="seu@email.com"/></div>
      <button class="btn btn-primary btn-full" id="btn-send-otp">Enviar CÃ³digo</button>
      <div class="login-switch"><button id="btn-reg-back">Voltar ao Login</button></div>
    </div>
    <div id="forgot-form" class="hidden">
      <div class="form-group"><label>Email</label><input type="email" class="form-control" placeholder="seu@email.com"/></div>
      <button class="btn btn-primary btn-full" id="btn-send-forgot">Enviar CÃ³digo de VerificaÃ§Ã£o</button>
      <div class="login-switch"><button id="btn-forgot-back">Voltar ao login</button></div>
    </div>
  </div>
</div>

<!-- â•â• ADM APP â•â• -->
<div id="app-page" class="hidden">
  <header class="app-header">
    <div style="display:flex;align-items:center;gap:12px">
      <button class="btn btn-ghost btn-icon mobile-menu-btn" id="menu-toggle">â˜°</button>
      <div class="header-logo">
        <span class="spark">âœ¦</span>
        <div><h2>WR Cleaning Service</h2><span>Painel Administrativo</span></div>
      </div>
    </div>
    <div class="header-right">
      <div class="user-info">
        <div class="name" id="header-username"></div>
        <div class="email" id="header-email"></div>
      </div>
      <button class="btn btn-outline btn-sm" id="btn-logout-adm">â¬¡ Sair</button>
    </div>
  </header>
  <div class="app-body">
    <div class="sidebar-overlay" id="sidebar-overlay"></div>
    <aside class="sidebar" id="sidebar">
      <nav role="navigation" aria-label="NavegaÃ§Ã£o principal">
        <button class="nav-item active" data-tab="dashboard" aria-label="Dashboard" aria-current="page"><svg class="icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg><span>Dashboard</span></button>
        <button class="nav-item" data-tab="schedule" aria-label="Agenda"><svg class="icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span>Agenda</span></button>
        <button class="nav-item" data-tab="checklist" aria-label="Pagamentos"><svg class="icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 1 0 0 7h5a3.5 3.5 0 1 1 0 7H6"/></svg><span>Pagamentos</span></button>
        <button class="nav-item" data-tab="clients" aria-label="Clientes"><svg class="icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg><span>Clientes</span></button>
        <button class="nav-item" data-tab="employees" aria-label="FuncionÃ¡rios"><svg class="icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><rect x="2" y="7" width="20" height="14" rx="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg><span>FuncionÃ¡rios</span></button>
        <button class="nav-item" data-tab="costs" aria-label="Custos"><svg class="icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg><span>Custos</span></button>
        <button class="nav-item" data-tab="notifications" aria-label="NotificaÃ§Ãµes"><svg class="icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg><span>NotificaÃ§Ãµes</span><span class="nav-badge hidden" id="notif-badge">0</span></button>
        <button class="nav-item" data-tab="frequencies" aria-label="FrequÃªncias"><svg class="icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><line x1="8" y1="14" x2="8.01" y2="14"/><line x1="12" y1="14" x2="12.01" y2="14"/></svg><span>FrequÃªncias</span></button>
        <button class="nav-item" data-tab="referrals" aria-label="IndicaÃ§Ãµes"><svg class="icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><polyline points="20 12 20 22 4 22 4 12"/><rect x="2" y="7" width="20" height="5"/><line x1="12" y1="22" x2="12" y2="7"/><path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"/><path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"/></svg><span>IndicaÃ§Ãµes</span></button>
        <button class="nav-item" data-tab="profile" aria-label="Perfil"><svg class="icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg><span>Perfil</span></button>
      </nav>
    </aside>
    <main class="main-content">
      <div class="notif-banner hidden" id="main-notif-banner">
        <span style="font-size:18px;color:var(--destructive)">ğŸ””</span>
        <div style="flex:1"><div class="title" id="banner-title"></div><div class="desc">ObservaÃ§Ãµes de funcionÃ¡rios aguardam sua visualizaÃ§Ã£o</div></div>
        <button class="btn btn-outline btn-sm" id="btn-banner-ver">Ver</button>
      </div>

      <!-- DASHBOARD -->
      <div class="tab-content active" id="tab-dashboard">
        <div class="card mb-4">
          <div class="card-header"><h3>Filtros de PerÃ­odo</h3></div>
          <div class="card-body">
            <div class="grid-3" style="gap:12px">
              <div class="form-group" style="margin:0"><label>Data Inicial</label><input type="date" class="form-control" id="dash-start" value="2026-02-01"/></div>
              <div class="form-group" style="margin:0"><label>Data Final</label><input type="date" class="form-control" id="dash-end" value="2026-02-28"/></div>
              <div class="form-group" style="margin:0"><label>MÃªs/Ano</label><input type="month" class="form-control" id="dash-month" value="2026-02"/></div>
            </div>
          </div>
        </div>
        <div class="grid-4 mb-4" id="dash-stats"></div>
        <div class="grid-3 mb-4" id="dash-secondary"></div>
        <div class="charts-grid mb-4">
          <div class="card"><div class="card-header"><h3>ğŸ“Š Receita vs Custo M.O.</h3></div><div class="chart-container"><canvas id="chart-revenue-cost"></canvas></div></div>
          <div class="card"><div class="card-header"><h3>ğŸ“ˆ Lucro por Trabalho</h3></div><div class="chart-container"><canvas id="chart-profit"></canvas></div></div>
        </div>
        <div class="card">
          <div class="card-header"><h3>Ranking de Lucratividade por Cliente</h3><div style="display:flex;gap:6px"><button class="btn btn-outline btn-sm" id="btn-export-csv">ğŸ“¥ CSV</button><button class="btn btn-outline btn-sm" id="btn-print-dash">ğŸ–¨ Imprimir</button></div></div>
          <div class="card-body table-responsive">
            <table class="table"><thead><tr><th>#</th><th>Cliente</th><th>FrequÃªncia</th><th style="text-align:right">Valor Cobrado</th><th style="text-align:right">Custo M.O.</th><th style="text-align:right">Lucro</th></tr></thead><tbody id="ranking-body"></tbody></table>
          </div>
        </div>
      </div>

      <!-- SCHEDULE -->
      <div class="tab-content" id="tab-schedule">
        <div class="page-header">
          <h2>ğŸ“… Agenda Semanal</h2>
          <div style="display:flex;gap:8px;align-items:center">
            <button class="btn btn-outline btn-sm" id="prev-week">â—€</button>
            <span id="week-label" style="font-size:13px;font-weight:600"></span>
            <button class="btn btn-outline btn-sm" id="next-week">â–¶</button>
            <button class="btn btn-primary btn-sm" id="btn-add-schedule">+ Adicionar</button>
          </div>
        </div>
        <div class="week-scroll-wrapper"><div class="week-grid" id="week-grid"></div></div>
        <div class="card mt-4"><div class="card-header"><h3>Lista de Agendamentos</h3><span id="schedule-count-badge" class="badge badge-gray" style="font-size:11px"></span></div><div class="card-body" id="schedule-list"></div></div>
      </div>

      <!-- CHECKLIST -->
      <div class="tab-content" id="tab-checklist">
        <div class="page-header">
          <h2>ğŸ’µ Registros de Trabalho</h2>
          <button class="btn btn-primary" id="btn-add-worklog">+ Novo Registro</button>
        </div>
        <div class="card mb-4">
          <div class="card-header"><h3>Filtros</h3></div>
          <div class="card-body">
            <div class="grid-3">
              <div class="form-group" style="margin:0"><label>Data Inicial</label><input type="date" class="form-control" id="cl-start" value="2026-02-01"/></div>
              <div class="form-group" style="margin:0"><label>Data Final</label><input type="date" class="form-control" id="cl-end" value="2026-02-28"/></div>
              <div class="form-group" style="margin:0"><label>MÃªs/Ano</label><input type="month" class="form-control" id="cl-month" value="2026-02"/></div>
            </div>
          </div>
        </div>
        <div class="grid-2 mb-4">
          <div class="card"><div class="card-header"><h3>Resumo por FuncionÃ¡ria</h3></div><div class="card-body" id="emp-payments-summary"></div></div>
          <div class="card"><div class="card-header"><h3>Status do PerÃ­odo</h3></div><div class="card-body" id="cl-period-stats"></div></div>
        </div>
        <div id="work-logs-list"></div>
      </div>

      <!-- CLIENTS -->
      <div class="tab-content" id="tab-clients">
        <div class="page-header"><h2>ğŸ‘¥ Clientes</h2><button class="btn btn-primary" id="btn-add-client">+ Adicionar Cliente</button></div>
        <div class="card"><div class="card-body table-responsive">
          <table class="table"><thead><tr><th>Nome</th><th>FrequÃªncia</th><th>Valor</th><th>FuncionÃ¡rias</th><th>Transporte</th><th>AÃ§Ãµes</th></tr></thead><tbody id="clients-table-body"></tbody></table>
        </div></div>
      </div>

      <!-- EMPLOYEES -->
      <div class="tab-content" id="tab-employees">
        <div class="tabs-nav">
          <div class="tab-btn active" id="emp-tab-active">FuncionÃ¡rios Ativos</div>
          <div class="tab-btn" id="emp-tab-pending">UsuÃ¡rios Pendentes</div>
        </div>
        <div id="active-emps">
          <div class="page-header"><h2>ğŸ’¼ FuncionÃ¡rios</h2><button class="btn btn-primary" id="btn-add-emp">+ Adicionar</button></div>
          <div class="card"><div class="card-body table-responsive">
            <table class="table"><thead><tr><th>Nome</th><th>Email</th><th>Papel</th><th>Desde</th><th>AÃ§Ãµes</th></tr></thead><tbody id="emp-table-body"></tbody></table>
          </div></div>
        </div>
        <div id="pending-users" class="hidden">
          <h2 style="font-size:20px;font-weight:800;margin-bottom:16px">â³ UsuÃ¡rios Pendentes</h2>
          <div id="pending-list"></div>
        </div>
      </div>

      <!-- COSTS -->
      <div class="tab-content" id="tab-costs">
        <div class="page-header"><h2>ğŸ§¾ Custos</h2><button class="btn btn-primary" id="btn-add-cost">+ Adicionar Custo</button></div>
        <div class="grid-2 mb-4">
          <div class="stat-card" style="border-left:4px solid var(--primary)"><div class="stat-label">ğŸ”„ Recorrentes / mÃªs</div><div class="stat-value" style="color:var(--primary)" id="cost-recurrent">$0.00</div></div>
          <div class="stat-card" style="border-left:4px solid var(--warning)"><div class="stat-label">âš¡ Ãšnicos</div><div class="stat-value" style="color:var(--warning)" id="cost-unique">$0.00</div></div>
        </div>
        <div style="display:flex;gap:8px;margin-bottom:16px">
          <button class="btn btn-outline btn-sm" style="border-radius:99px" id="filter-all">Todos</button>
          <button class="btn btn-outline btn-sm" style="border-radius:99px" id="filter-recorrente">Recorrentes</button>
          <button class="btn btn-outline btn-sm" style="border-radius:99px" id="filter-unico">Ãšnicos</button>
        </div>
        <div id="costs-list"></div>
      </div>

      <!-- NOTIFICATIONS -->
      <div class="tab-content" id="tab-notifications">
        <div class="page-header">
          <h2>ğŸ”” NotificaÃ§Ãµes</h2>
          <span class="badge badge-destructive" id="notif-count-badge"></span>
        </div>
        <div id="notifications-list"></div>
      </div>

      <!-- FREQUENCIES -->
      <div class="tab-content" id="tab-frequencies">
        <div class="page-header"><h2>ğŸ“† FrequÃªncias</h2><button class="btn btn-primary" id="btn-add-freq">+ Adicionar</button></div>
        <div class="card"><div class="card-header"><h3>ğŸ“‹ Lista de FrequÃªncias</h3></div><div class="card-body" id="freq-list"></div></div>
      </div>

      <!-- REFERRALS -->
      <div class="tab-content" id="tab-referrals">
        <div class="page-header"><h2>ğŸ IndicaÃ§Ãµes</h2></div>
        <div class="grid-3 mb-4" id="referral-stats"></div>
        <div id="referrals-list"></div>
      </div>

      <!-- PROFILE -->
      <div class="tab-content" id="tab-profile">
        <h2 style="font-size:22px;font-weight:800;margin-bottom:20px">âš™ Perfil</h2>
        <div class="card" style="max-width:480px"><div class="card-body">
          <div style="display:flex;align-items:center;gap:16px;margin-bottom:24px">
            <div class="profile-avatar" id="profile-avatar">A</div>
            <div><div style="font-size:18px;font-weight:700" id="profile-name">Admin</div><div style="font-size:13px;color:var(--text-muted)" id="profile-email-disp"></div><span class="badge badge-primary" style="margin-top:4px">Administrador</span></div>
          </div>
          <hr class="divider">
          <div class="form-group"><label>Nova Senha</label><input type="password" class="form-control" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢"/></div>
          <div class="form-group"><label>Confirmar Senha</label><input type="password" class="form-control" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢"/></div>
          <button class="btn btn-primary" id="btn-save-profile">Salvar AlteraÃ§Ãµes</button>
        </div></div>
      </div>
    </main>
  </div>
</div>

<!-- â•â• EMPLOYEE APP â•â• -->
<div id="emp-app-page" class="hidden">
  <header class="app-header">
    <div class="header-logo"><span class="spark">âœ¦</span><div><h2>WR Cleaning</h2><span id="emp-header-sub">Colaboradora</span></div></div>
    <div class="header-right">
      <div class="user-info"><div class="name" id="emp-header-username"></div><div class="email" id="emp-header-email"></div></div>
      <button class="btn btn-outline btn-sm" id="btn-logout-emp">â¬¡ Sair</button>
    </div>
  </header>
  <div style="background:var(--card);border-bottom:1px solid var(--border);overflow-x:auto">
    <div style="display:flex;min-width:max-content;padding:0 16px">
      <button class="emp-tab-btn active" data-etab="emp-ganhos">ğŸ’° Ganhos</button>
      <button class="emp-tab-btn" data-etab="emp-agenda">ğŸ“… Agenda</button>
      <button class="emp-tab-btn" data-etab="emp-clientes">ğŸ‘¥ Clientes</button>
      <button class="emp-tab-btn" data-etab="emp-indique">ğŸ Indique</button>
      <button class="emp-tab-btn" data-etab="emp-perfil">âš™ï¸ Perfil</button>
    </div>
  </div>
  <main class="main-content">
    <!-- GANHOS -->
    <div class="tab-content active" id="tab-emp-ganhos">
      <h2 style="font-size:20px;font-weight:800;margin-bottom:16px">ğŸ’° Meus Ganhos</h2>
      <div class="card mb-4"><div class="card-body" style="padding:12px 16px">
        <div style="display:flex;gap:8px;flex-wrap:wrap">
          <button class="btn btn-outline btn-sm" style="border-radius:99px" data-period="semana">Esta semana</button>
          <button class="btn btn-primary btn-sm" style="border-radius:99px" data-period="mes">Este mÃªs</button>
          <button class="btn btn-outline btn-sm" style="border-radius:99px" data-period="ano">Este ano</button>
        </div>
      </div></div>
      <div class="grid-3 mb-4" id="emp-stats"></div>
      <div class="card"><div class="card-header"><h3>HistÃ³rico de Trabalhos</h3></div><div class="card-body" id="emp-work-list"></div></div>
    </div>
    <!-- AGENDA -->
    <div class="tab-content" id="tab-emp-agenda">
      <div class="page-header">
        <h2>ğŸ“… Minha Agenda</h2>
        <div style="display:flex;gap:8px;align-items:center">
          <button class="btn btn-outline btn-sm" id="emp-prev-week">â—€</button>
          <span id="emp-week-label" style="font-size:13px;font-weight:600"></span>
          <button class="btn btn-outline btn-sm" id="emp-next-week">â–¶</button>
        </div>
      </div>
      <div class="week-grid" id="emp-week-grid"></div>
      <div class="card mt-4"><div class="card-header"><h3>Agendamentos da Semana</h3></div><div class="card-body" id="emp-schedule-list"></div></div>
    </div>
    <!-- CLIENTES -->
    <div class="tab-content" id="tab-emp-clientes">
      <h2 style="font-size:20px;font-weight:800;margin-bottom:16px">ğŸ‘¥ Meus Clientes</h2>
      <div id="emp-clients-list"></div>
      <div class="card mt-4">
        <div class="card-header"><h3>ğŸ’¬ Minhas ObservaÃ§Ãµes</h3><button class="btn btn-primary btn-sm" id="btn-emp-note">+ Nova ObservaÃ§Ã£o</button></div>
        <div class="card-body" id="emp-notes-list"></div>
      </div>
    </div>
    <!-- INDIQUE -->
    <div class="tab-content" id="tab-emp-indique">
      <div class="page-header"><h2>ğŸ IndicaÃ§Ãµes</h2><button class="btn btn-primary" id="btn-emp-ref">+ Nova IndicaÃ§Ã£o</button></div>
      <div class="card mb-4" style="border-left:4px solid var(--secondary);background:var(--secondary-light)">
        <div class="card-body"><div style="font-weight:700;color:var(--secondary);margin-bottom:4px">ğŸ Como funciona?</div><div style="font-size:13px;color:#065f46">Indique um amigo e receba bÃ´nus quando aprovado!</div></div>
      </div>
      <div class="grid-3 mb-4" id="emp-referrals-stats"></div>
      <div id="emp-referrals-list"></div>
    </div>
    <!-- PERFIL -->
    <div class="tab-content" id="tab-emp-perfil">
      <h2 style="font-size:20px;font-weight:800;margin-bottom:16px">âš™ï¸ Meu Perfil</h2>
      <div class="card" style="max-width:480px"><div class="card-body">
        <div style="display:flex;align-items:center;gap:16px;margin-bottom:24px">
          <div class="profile-avatar" id="emp-profile-avatar">A</div>
          <div><div style="font-size:18px;font-weight:700" id="emp-profile-name">Colaboradora</div><div style="font-size:13px;color:var(--text-muted)" id="emp-profile-email"></div><span class="badge badge-gray" style="margin-top:4px">Colaborador</span></div>
        </div>
        <hr class="divider">
        <div class="form-group"><label>Nova Senha</label><input type="password" class="form-control" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢"/></div>
        <div class="form-group"><label>Confirmar Senha</label><input type="password" class="form-control" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢"/></div>
        <button class="btn btn-primary btn-sm" id="btn-save-emp-profile">Salvar Senha</button>
      </div></div>
    </div>
  </main>
</div>

<!-- â•â• MODALS â•â• -->
<div class="modal-overlay hidden" id="schedule-modal">
  <div class="modal modal-lg"><h2>ğŸ“… Novo Agendamento</h2>
    <div class="form-group"><label>Data</label><input type="date" class="form-control" id="sch-date"/></div>
    <div class="form-group"><label>Cliente</label><select class="form-control" id="sch-client"><option value="">Selecione...</option></select></div>
    <div class="form-group"><label>FuncionÃ¡ria</label><select class="form-control" id="sch-emp"><option value="">Selecione...</option></select></div>
    <div class="form-group"><label>Status</label><select class="form-control" id="sch-status"><option value="pendente">Pendente</option><option value="confirmado">Confirmado</option><option value="cancelado">Cancelado</option></select></div>
    <div class="form-group"><label>ObservaÃ§Ãµes</label><textarea class="form-control" id="sch-notes" placeholder="Opcional..."></textarea></div>
    <div style="display:flex;gap:8px"><button class="btn btn-primary" id="btn-save-schedule">Salvar</button><button class="btn btn-outline" id="btn-cancel-schedule">Cancelar</button></div>
  </div>
</div>

<div class="modal-overlay hidden" id="checklist-modal">
  <div class="modal modal-lg">
    <h2 id="checklist-modal-title">ğŸ’µ Novo Registro de Trabalho</h2>
    <input type="hidden" id="cl-edit-id"/>
    <div class="form-group"><label>Cliente</label><select class="form-control" id="cl-client"><option value="">Selecione...</option></select></div>
    <div class="form-group"><label>Data</label><input type="date" class="form-control" id="cl-date"/></div>
    <div class="form-group"><label>Status</label>
      <select class="form-control" id="cl-status">
        <option value="Pendente">Pendente</option>
        <option value="Confirmado">Confirmado</option>
        <option value="Cancelado">Cancelado</option>
      </select>
    </div>
    <div class="form-group hidden" id="cl-reason-group"><label>Motivo do Cancelamento</label><textarea class="form-control" id="cl-reason"></textarea></div>
    <div class="form-group"><label>Receita (R$)</label><input type="number" class="form-control" id="cl-revenue" placeholder="0.00" step="0.01"/></div>
    <hr class="divider">
    <div style="margin-bottom:10px;font-weight:600;font-size:14px">FuncionÃ¡rias no Trabalho</div>
    <div id="cl-emp-rows"></div>
    <button class="btn btn-ghost btn-sm" id="btn-add-emp-row">+ Adicionar FuncionÃ¡ria</button>
    <div style="display:flex;gap:8px;margin-top:16px"><button class="btn btn-primary" id="btn-save-worklog">Salvar</button><button class="btn btn-outline" id="btn-cancel-worklog">Cancelar</button></div>
  </div>
</div>

<div class="modal-overlay hidden" id="client-modal">
  <div class="modal modal-lg">
    <h2 id="client-modal-title">ğŸ‘¥ Adicionar Cliente</h2>
    <input type="hidden" id="client-edit-id"/>
    <div class="form-group"><label>Nome</label><input type="text" class="form-control" id="client-name" placeholder="Nome do cliente"/></div>
    <div class="form-group"><label>FrequÃªncia</label><select class="form-control" id="client-freq"><option value="">Selecione...</option></select></div>
    <div class="form-group"><label>Valor (R$)</label><input type="number" class="form-control" id="client-price" placeholder="0.00" step="0.01"/></div>
    <div class="form-group" style="display:flex;align-items:center;gap:8px"><input type="checkbox" id="client-transport" style="width:16px;height:16px"/><label for="client-transport" style="margin:0">Sem custo de transporte</label></div>
    <hr class="divider">
    <div style="font-weight:600;font-size:14px;margin-bottom:10px">FuncionÃ¡rias Designadas</div>
    <div id="client-emp-rows"></div>
    <button class="btn btn-ghost btn-sm" id="btn-add-client-emp">+ Adicionar FuncionÃ¡ria</button>
    <div style="display:flex;gap:8px;margin-top:16px"><button class="btn btn-primary" id="btn-save-client">Salvar</button><button class="btn btn-outline" id="btn-cancel-client">Cancelar</button></div>
  </div>
</div>

<div class="modal-overlay hidden" id="emp-modal">
  <div class="modal">
    <h2>ğŸ’¼ Adicionar FuncionÃ¡rio</h2>
    <div class="form-group"><label>Nome completo</label><input type="text" class="form-control" id="emp-name" placeholder="Nome completo"/></div>
    <div class="form-group"><label>Email (login)</label><input type="email" class="form-control" id="emp-email" placeholder="email@exemplo.com"/></div>
    <div class="form-group">
      <label>Senha</label>
      <div class="pass-wrapper">
        <input type="password" class="form-control" id="emp-pass" placeholder="MÃ­nimo 6 caracteres"/>
        <button class="pass-toggle" type="button" onclick="toggleFieldPass('emp-pass',this)" aria-label="Mostrar senha">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
        </button>
      </div>
    </div>
    <div class="form-group"><label>Papel</label>
      <select class="form-control" id="emp-role">
        <option value="colaborador">Colaborador</option>
        <option value="adm">Administrador</option>
      </select>
    </div>
    <div style="display:flex;gap:8px;margin-top:4px"><button class="btn btn-primary" id="btn-save-emp">âœ… Criar FuncionÃ¡rio</button><button class="btn btn-outline" id="btn-cancel-emp">Cancelar</button></div>
  </div>
</div>

<!-- â•â• MODAL EDITAR FUNCIONÃRIO â•â• -->
<div class="modal-overlay hidden" id="edit-emp-modal">
  <div class="modal">
    <h2>âœï¸ Editar FuncionÃ¡rio</h2>
    <input type="hidden" id="edit-emp-id"/>
    <div class="form-group"><label>Nome completo</label><input type="text" class="form-control" id="edit-emp-name" placeholder="Nome completo"/></div>
    <div class="form-group"><label>Email (login)</label><input type="email" class="form-control" id="edit-emp-email" placeholder="email@exemplo.com"/></div>
    <div class="form-group">
      <label>Nova Senha <span style="font-size:11px;color:var(--text-muted)">(deixe em branco para manter)</span></label>
      <div class="pass-wrapper">
        <input type="password" class="form-control" id="edit-emp-pass" placeholder="Nova senha (opcional)"/>
        <button class="pass-toggle" type="button" onclick="toggleFieldPass('edit-emp-pass',this)" aria-label="Mostrar senha">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
        </button>
      </div>
    </div>
    <div class="form-group"><label>Papel</label>
      <select class="form-control" id="edit-emp-role">
        <option value="colaborador">Colaborador</option>
        <option value="adm">Administrador</option>
      </select>
    </div>
    <div style="display:flex;gap:8px;margin-top:4px"><button class="btn btn-primary" id="btn-save-edit-emp">ğŸ’¾ Salvar AlteraÃ§Ãµes</button><button class="btn btn-outline" id="btn-cancel-edit-emp">Cancelar</button></div>
  </div>
</div>

<div class="modal-overlay hidden" id="cost-modal">
  <div class="modal"><h2>ğŸ§¾ Adicionar Custo</h2>
    <div class="form-group"><label>Categoria</label><select class="form-control" id="cost-cat"><option>Transporte</option><option>Produtos de Limpeza</option><option>ManutenÃ§Ã£o</option><option>Outros</option></select></div>
    <div class="form-group"><label>DescriÃ§Ã£o</label><input type="text" class="form-control" id="cost-desc" placeholder="DescriÃ§Ã£o"/></div>
    <div class="form-group"><label>Valor (R$)</label><input type="number" class="form-control" id="cost-amount" placeholder="0.00" step="0.01"/></div>
    <div class="form-group"><label>Tipo</label><select class="form-control" id="cost-type"><option value="unico">Ãšnico</option><option value="recorrente">Recorrente</option></select></div>
    <div style="display:flex;gap:8px"><button class="btn btn-primary" id="btn-save-cost">Adicionar</button><button class="btn btn-outline" id="btn-cancel-cost">Cancelar</button></div>
  </div>
</div>

<div class="modal-overlay hidden" id="freq-modal">
  <div class="modal">
    <h2 id="freq-modal-title">ğŸ“† Adicionar FrequÃªncia</h2>
    <input type="hidden" id="freq-edit-id"/>
    <div class="form-group"><label>Nome</label><input type="text" class="form-control" id="freq-name" placeholder="Ex: Semanal, Quinzenal..."/></div>
    <div style="display:flex;gap:8px"><button class="btn btn-primary" id="btn-save-freq">Salvar</button><button class="btn btn-outline" id="btn-cancel-freq">Cancelar</button></div>
  </div>
</div>

<div class="modal-overlay hidden" id="approve-modal">
  <div class="modal"><h2>âœ… Aprovar UsuÃ¡rio</h2>
    <input type="hidden" id="approve-user-id"/>
    <div class="form-group"><label>Nome do FuncionÃ¡rio</label><input type="text" class="form-control" id="approve-name" placeholder="Nome completo"/></div>
    <div class="form-group">
      <label>Senha inicial</label>
      <div class="pass-wrapper">
        <input type="password" class="form-control" id="approve-pass" placeholder="MÃ­nimo 6 caracteres" value="123456"/>
        <button class="pass-toggle" type="button" onclick="toggleFieldPass('approve-pass',this)" aria-label="Mostrar senha">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
        </button>
      </div>
    </div>
    <div class="form-group"><label>Papel</label>
      <select class="form-control" id="approve-role">
        <option value="colaborador">Colaborador</option>
        <option value="adm">Administrador</option>
      </select>
    </div>
    <div style="display:flex;gap:8px"><button class="btn btn-secondary" id="btn-approve-user">âœ… Aprovar e Criar Login</button><button class="btn btn-outline" id="btn-cancel-approve">Cancelar</button></div>
  </div>
</div>

<div class="modal-overlay hidden" id="ref-modal">
  <div class="modal"><h2>ğŸ Aprovar IndicaÃ§Ã£o</h2>
    <input type="hidden" id="ref-edit-id"/>
    <div class="form-group"><label>Valor do BÃ´nus (R$)</label><input type="number" class="form-control" id="ref-bonus" placeholder="0.00" step="0.01"/></div>
    <div style="display:flex;gap:8px"><button class="btn btn-secondary" id="btn-approve-ref">Aprovar com BÃ´nus</button><button class="btn btn-outline" id="btn-cancel-ref">Cancelar</button></div>
  </div>
</div>

<div class="modal-overlay hidden" id="emp-note-modal">
  <div class="modal"><h2>ğŸ’¬ Nova ObservaÃ§Ã£o</h2>
    <div class="form-group"><label>Cliente</label><select class="form-control" id="note-client-sel"></select></div>
    <div class="form-group"><label>ObservaÃ§Ã£o</label><textarea class="form-control" id="note-text" rows="4" placeholder="Descreva sua observaÃ§Ã£o..."></textarea></div>
    <div style="display:flex;gap:8px"><button class="btn btn-primary" id="btn-save-note">Enviar</button><button class="btn btn-outline" id="btn-cancel-note">Cancelar</button></div>
  </div>
</div>

<div class="modal-overlay hidden" id="emp-ref-modal">
  <div class="modal"><h2>ğŸ Nova IndicaÃ§Ã£o</h2>
    <div class="form-group"><label>Nome do Cliente</label><input type="text" class="form-control" id="eref-name" placeholder="Nome completo"/></div>
    <div class="form-group"><label>Telefone</label><input type="text" class="form-control" id="eref-phone" placeholder="(11) 99999-9999"/></div>
    <div class="form-group"><label>EndereÃ§o</label><input type="text" class="form-control" id="eref-address" placeholder="Rua, nÃºmero, bairro"/></div>
    <div class="form-group"><label>CEP</label><input type="text" class="form-control" id="eref-zip" placeholder="00000-000"/></div>
    <div style="display:flex;gap:8px"><button class="btn btn-primary" id="btn-save-emp-ref">Enviar</button><button class="btn btn-outline" id="btn-cancel-emp-ref">Cancelar</button></div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
// CONFIGURAÃ‡ÃƒO SUPABASE
const SUPABASE_URL = 'https://gdemuefknpfaajfrzvpu.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVvbHN0anp6eXRjZWx5b2Zsd3B3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIwMzY2MzksImV4cCI6MjA4NzYxMjYzOX0.roprEFZUN5r8Z5c-f_D06SHm0xSoSU0ecCjCiGDtqbU';
const sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

// ESTADO GLOBAL (Substituindo db e USERS)
let currentUser = null;
let currentTab = 'dashboard';
let costsFilter = 'all';
let weekOffset = 0;
let empWeekOffset = 0;
let currentEmpId = null;
let empPeriodDates = {start:'', end:''};

// UTILITÃRIOS
const fmt = v => 'R$ ' + Number(v).toFixed(2);
const fmtDate = s => {
  if(!s) return '-';
  const d = new Date(s + (s.length === 10 ? 'T00:00:00' : ''));
  return d.toLocaleDateString('pt-BR');
};
const $ = id => document.getElementById(id);

function toast(msg, type='success') {
  const c = $('toast-container');
  if(!c) return;
  const el = document.createElement('div');
  el.className = `toast ${type}`;
  el.innerHTML = `${type === 'success' ? 'âœ“' : 'âœ•'} ${msg}`;
  c.appendChild(el);
  setTimeout(() => el.remove(), 3500);
}

function openModal(id) { $(id).classList.remove('hidden'); }
function closeModal(id) { $(id).classList.add('hidden'); }

// FECHAR MODAIS NO CLIQUE FORA
document.querySelectorAll('.modal-overlay').forEach(o => o.addEventListener('click', e => {
  if(e.target === o) o.classList.add('hidden');
}));

// AUTENTICAÃ‡ÃƒO SUPABASE
async function doLogin() {
  const emailEl = $('login-email'), passEl = $('login-pass');
  const email = (emailEl.value || '').trim().toLowerCase();
  const pass = passEl.value;

  if(!email || !pass) {
    toast('Preencha email e senha', 'error');
    return;
  }

  const { data, error } = await sb.auth.signInWithPassword({ email, password: pass });
  
  if(error) {
    toast('Erro no login: ' + error.message, 'error');
    return;
  }

  currentUser = data.user;
  const { data: profile } = await sb.from('profiles').select('*').eq('id', currentUser.id).single();
  
  if(!profile) {
    toast('Perfil nÃ£o encontrado!', 'error');
    return;
  }

  $('login-page').classList.add('hidden');
  if(profile.role === 'adm') {
    $('app-page').classList.remove('hidden');
    $('header-username').textContent = profile.display_name;
    $('header-email').textContent = currentUser.email;
    initApp();
  } else {
    $('emp-app-page').classList.remove('hidden');
    $('emp-header-username').textContent = profile.display_name;
    $('emp-header-email').textContent = currentUser.email;
    initEmpApp(currentUser.id);
  }
}

async function doLogout() {
  await sb.auth.signOut();
  location.reload();
}

// NAVEGAÃ‡ÃƒO
function navigate(tab) {
  document.querySelectorAll('#sidebar .nav-item').forEach(b => b.classList.remove('active'));
  const nb = document.querySelector(`#sidebar [data-tab="${tab}"]`);
  if(nb) nb.classList.add('active');
  
  document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
  const targetTab = $('tab-' + tab);
  if(targetTab) targetTab.classList.add('active');
  
  currentTab = tab;
  renderTab(tab);
}

async function renderTab(tab) {
  const renderers = {
    dashboard: renderDashboard,
    schedule: renderSchedule,
    checklist: renderChecklist,
    clients: renderClients,
    employees: renderEmployees,
    costs: renderCosts,
    notifications: renderNotifications,
    referrals: renderReferrals
  };
  if(renderers[tab]) await renderers[tab]();
}

// EXPLO: RENDERIZAR CLIENTES (Conectado ao Supabase)
async function renderClients() {
  const { data: clients, error } = await sb.from('clients').select('*, client_employees(employee_id, payment_amount)');
  if(error) { toast('Erro ao carregar clientes', 'error'); return; }
  
  const { data: employees } = await sb.from('employees').select('id, name');
  const empMap = Object.fromEntries(employees.map(e => [e.id, e.name]));

  $('clients-table-body').innerHTML = clients.map(c => {
    const emps = (c.client_employees || []).map(ce => 
      `<span class="emp-pill">${empMap[ce.employee_id] || '?'} ${fmt(ce.payment_amount)}</span>`
    ).join(' ');
    
    return `<tr>
      <td><strong>${c.name}</strong></td>
      <td><span class="badge badge-gray">${c.frequency}</span></td>
      <td><strong style="color:var(--secondary)">${fmt(c.price)}</strong></td>
      <td>${emps || '<span style="color:var(--text-muted)">Nenhuma</span>'}</td>
      <td>${c.no_transport_cost ? '<span class="badge badge-secondary">Sim</span>' : '<span class="badge badge-gray">NÃ£o</span>'}</td>
      <td>
        <div style="display:flex;gap:4px">
          <button class="btn btn-ghost btn-icon btn-sm" onclick="editClient('${c.id}')">âœ</button>
          <button class="btn btn-danger btn-icon btn-sm" onclick="deleteClient('${c.id}')">ğŸ—‘</button>
        </div>
      </td>
    </tr>`;
  }).join('');
}

// INICIALIZAÃ‡ÃƒO
async async function initApp() {
  await renderDashboard();
  // Carregar outros dados conforme necessÃ¡rio
}

// EVENTOS DE CLICK (Delegation ou diretos)
document.addEventListener('DOMContentLoaded', () => {
  // Restaura sessÃ£o ativa (usuÃ¡rio nÃ£o precisa logar de novo ao recarregar)
  sb.auth.getSession().then(async ({ data: { session } }) => {
    if (!session) return;
    const user = session.user;
    const { data: profile } = await sb.from('profiles')
      .select('role, display_name')
      .eq('id', user.id)
      .single();
    if (!profile) return;
    currentUser = { role: profile.role, email: user.email, username: profile.display_name, employeeId: user.id };
    $('login-page').classList.add('hidden');
    if (profile.role === 'adm') {
      $('app-page').classList.remove('hidden');
      if($('header-username')) $('header-username').textContent = profile.display_name;
      if($('header-email'))    $('header-email').textContent    = user.email;
      if($('profile-name'))    $('profile-name').textContent    = profile.display_name;
      if($('profile-avatar'))  $('profile-avatar').textContent  = profile.display_name.charAt(0).toUpperCase();
      await initApp();
    } else {
      $('emp-app-page').classList.remove('hidden');
      if($('emp-header-username')) $('emp-header-username').textContent = profile.display_name;
      if($('emp-header-email'))    $('emp-header-email').textContent    = user.email;
      initEmpApp(user.id);
    }
  });

  const loginBtn = $('btn-login');
  if(loginBtn) loginBtn.onclick = doLogin;
  
  const logoutBtn = $('btn-logout');
  if(logoutBtn) logoutBtn.onclick = doLogout;
  const logoutAdmBtn = $('btn-logout-adm');
  if(logoutAdmBtn) logoutAdmBtn.onclick = doLogout;
  
  const logoutEmpBtn = $('btn-logout-emp');
  if(logoutEmpBtn) logoutEmpBtn.onclick = doLogout;

  // Sidebar navigation
  document.querySelectorAll('#sidebar .nav-item').forEach(item => {
    item.onclick = () => navigate(item.dataset.tab);
  });
});

// NOTA: Esta Ã© uma versÃ£o simplificada para mostrar a estrutura.
// Para um sistema completo, cada funÃ§Ã£o (saveClient, saveEmployee, etc) 
// deve ser convertida para usar sb.from('tabela').insert/update().
</script>
</body></html>
